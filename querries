-- Trabalho INF0211A --

-- 1.	Exibir os nomes das equipes e local de suas sedes, com os nomes de seus pilotos.

SELECT DISTINCT e.nome, e.sede, p1.nome
FROM equipe e, pontuacao p, piloto p1
WHERE e.cod = p.cod_equipe
AND p1.cod = p.cod_piloto
ORDER BY e.nome

-- 3.	Exibir a relação de provas do campeonato com as datas de realização, cidade e país,  em ordem crescente de data.

SELECT p.data, c.nome 
FROM prova p, circuito c 
WHERE c.cod = p.cod_circuito
ORDER BY p.data ASC

-- 4.	Exibir o nome e a equipe do piloto com melhor classificação e seu número de pontos,
-- e do piloto com pior classificação e seu número de pontos (em um ano específico, e por ano).

-- menor em um ano especifico
SELECT p1.nome, p.pontos, e.nome, p.cod_campeonato
FROM pontuacao p, piloto p1, equipe e
WHERE p.cod_campeonato = 2006
AND p1.cod = p.cod_piloto
ORDER BY p.pontos
limit 1

-- maior em um ano especifico
SELECT p1.nome, p.pontos, e.nome, p.cod_campeonato
FROM pontuacao p, piloto p1, equipe e
WHERE p.cod_campeonato = 2006
AND p1.cod = p.cod_piloto
ORDER BY p.pontos DESC
limit 1

-- menor por ano
SELECT p1.nome, p.pontos, e.nome, p.cod_campeonato
FROM pontuacao p, piloto p1, equipe e, campeonato c
WHERE p.cod_campeonato = c.ano
AND p1.cod =(SELECT p.cod_piloto
		FROM pontuacao p
		WHERE p.pontos > 0
		AND c.ano = p.cod_campeonato
		ORDER BY p.pontos
		LIMIT 1)
AND p.cod_piloto = p1.cod
AND p.cod_equipe = e.cod
ORDER BY p.cod_campeonato

-- maior por ano
SELECT p1.nome, p.pontos, e.nome, p.cod_campeonato
FROM pontuacao p, piloto p1, equipe e, campeonato c
WHERE p.cod_campeonato = c.ano
AND p1.cod = (SELECT p.cod_piloto
		FROM pontuacao p
		WHERE c.ano = p.cod_campeonato
		ORDER BY p.pontos DESC
		LIMIT 1)
AND p.cod_piloto = p1.cod
AND p.cod_equipe = e.cod
ORDER BY p.cod_campeonato


-- 5. Exibir os nomes dos pilotos vencedores de cada prova (circuito), suas equipes
-- e seus pontos, em ordem crescente de pontos (em um ano específico).

SELECT p.nome, ci.nome
FROM piloto p, prova pr, circuito ci, grid g
WHERE g.chegada = 1
AND g.cod_campeonato = 2006
AND g.cod_piloto = p.cod
AND g.cod_circuito =  ci.cod
ORDER BY g.cod_circuito


